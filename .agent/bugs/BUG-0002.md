---
id: BUG-0002
title: Budget day detail expanded trip purchase list not scrollable
severity: medium
status: fixed
reported: 2026-02-09
fixed: 2026-02-09
affected_views:
  - BudgetDayDetail (Budget > click on day total)
---

# BUG-0002: Budget day detail expanded trip purchase list not scrollable

## Summary

When viewing a day's budget details and expanding a trip entry to see individual purchases, the purchase list can extend beyond the visible area of the modal. There is no scroll mechanism on the expanded section, making it impossible to see or interact with items at the bottom of the list. The entire modal has a max-height constraint, but the expanded trip content doesn't respect it by flowing within a scrollable container correctly.

## Steps to Reproduce

1. Have a trip with many purchases (e.g., 8+ items for a single store stop)
2. Navigate to Budget view
3. Click on a day cell's total spent amount to open `BudgetDayDetail`
4. Find the trip expense entry and click the expand chevron or eye icon
5. The trip details and purchase list expand inline

## Expected Behavior

The expanded purchase list should be scrollable within the modal. The user should be able to scroll through all purchases to see every item, including those beyond the initial viewport.

## Actual Behavior

The expanded purchase list renders all items, pushing content beyond the modal's visible area. The bottom items are cut off and there is no scrollbar to reach them. The modal outer container has `max-h-[90vh] sm:max-h-[85vh] flex flex-col` and the entries list div has `flex-1 overflow-auto`, **however** the expanded trip content within the entries section creates a very tall block that should scroll within `overflow-auto` — the issue may be that the expanded content is within nested divs that don't properly constrain height.

## Screenshots

| Label | Description |
|-------|-------------|
| SC4 | Budget > Day Detail > expanded trip showing a long purchase list that extends beyond visible area, no scrollbar visible on the expanded section |

## Affected Components

| Component | File Path | Role |
|-----------|-----------|------|
| `BudgetDayDetail` | `client/src/components/budget/BudgetDayDetail.vue` | Budget day popout modal — the expanded trip section overflows |

## Root Cause Analysis

Examining `BudgetDayDetail.vue`:

1. **Modal outer**: `max-h-[90vh] sm:max-h-[85vh] flex flex-col` (line 125) ✅ Sets height constraint
2. **Scrollable area**: `flex-1 overflow-auto p-4` (line 163) ✅ Should enable scrolling
3. **Expanded trip content**: `ml-2 mt-3 space-y-3` (line 309) — this div expands freely inside the scroll container

The `overflow-auto` on line 163 **should** allow scrolling of the entire entries section. If it's not scrolling, the likely cause is one of:

- **A**: The modal container's `flex flex-col` chain is broken — some intermediate div doesn't have the proper flex properties
- **B**: The content area doesn't have a constrained height from its parent, so `overflow-auto` doesn't activate
- **C**: A browser/OS-specific issue where the Teleport container doesn't respect flex constraints

**Most likely cause**: The expanded trip section creates a very tall content block. The `overflow-auto` on the parent **should** give a scrollbar for the entire entries section, but if the outer flex container or the `Teleport` wrapper isn't properly constraining height to `max-h-[85vh]`, the scroll won't activate.

## Fix Strategy

### Option A: Verify the flex chain (likely fix)
Confirm the height constraint cascades properly:
```
Teleport > fixed backdrop > modal container (max-h-85vh, flex-col) 
  > header (shrink-0) 
  > summary (shrink-0) 
  > entries (flex-1 overflow-auto) ← must have bounded height
  > footer (shrink-0)
```
If any wrapper div between the modal container and the entries section is missing `flex-1 min-h-0` or `overflow-hidden`, the scroll won't activate. The key fix is often adding `min-h-0` to flex children that need to shrink below their content size.

### Option B: Add max-height to the expanded trip section
If the outer scroll works but the expanded section itself is too long:
```html
<div 
  v-if="entry.is_trip && isTripExpanded(entry.id)"
  class="ml-2 mt-3 space-y-3 max-h-[40vh] overflow-auto"
>
```
This gives the expanded trip its own scroll area, limiting it to 40% of viewport.

### Option C: Combine both
Ensure the outer scroll works **and** add a reasonable max-height to the expanded section as a safety net.

### Relevant Skills & Workflows
- **Skill**: `common-problems` — Category 2 (CSS Overflow / Scroll Issues) documents exactly this modal pattern
- **Skill**: `bug-noting` — Used to file this bug
- **KI**: `GUI Design System and Implementation Standards` — documents modal layout patterns

### Common Problems to Check
- See `.agent/skills/common-problems/SKILL.md` Category 2: CSS Overflow / Scroll Issues — the "Template" section shows the exact pattern needed

## Linked Bugs
- Related: BUG-0001 (purchase display inconsistency in the same views — different problem, same component)

## Resolution

**Fixed 2026-02-09** — One change applied:

1. **`BudgetDayDetail.vue`**: Added `max-h-[50vh] overflow-auto` to the expanded trip section container (`class="ml-2 mt-3 space-y-3"` → `class="ml-2 mt-3 space-y-3 max-h-[50vh] overflow-auto"`).

**Skill created**: `.agent/skills/fix-modal-overflow/SKILL.md`
